%Goal of code: To factor A and output its LU, given A is banded and t=2 and s=1.
clc,clearvars

% Set n=3
n = 6;

% Create random n√ón matrix A
% Create a copy of A
disp("A before:")
A = [1 7 12 0 0 0 ; 17 2 8 13 0 0; 0 18 3 9 14 0; 0 0 19 4 10 15; 0 0 0 20 5 11; 0 0 0 0 21 6]
T=A;
L=eye(n);
s=1;
t=2;

for k=1:n-1 
    % k= What column Im starting on

    for i =k+1:k+s 
        % i= What row im starting off (below pivot)
        % K is constant
        
        L(i,k)= A(i,k)/A(k,k); %Get my factors for L for that whole k column AFTER performing row operations below each time
        A(i,k)=0; %Because we know that will have to be zero

        for j=k+1:k+t %Start off with k+1 because we made other entry zero already
            % Perfom row operation
            % j = what column im in each time til i reach the end
            % I and K are constants

            A(i,j) = A(i,j) - L(i,k)*A(k,j); %Notice how A(I,j) is RIGHT BELOW A(K,j)

        end
    end
end

U = A;
disp("A/U after:")
U

disp("L after:")
L

disp("L*U:")
B=L*U

if (T==B)
    disp("The factorization is correct.");
else
    disp("The factorization is incorrect.");
end
